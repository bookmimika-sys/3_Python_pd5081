Dla programu wygenerowałam plik z sekwencjami wziętymi z bazy NCBI.
1. Tworzę funkcję sprawdz_sekwencje_dna, która pobiera sekwencję i sprawdza, czy zawiera wyłącznie dozwolone nukleotydy. Zwraca ona wartość True, jeśli sekwencja jest prawidłowa, lub False, gdy jest niepoprawna.
2. W dalszych krokach zczytuję sekwencje z pliku za pomocą parsera zaimportowanego z biblioteki Biopython. Gdy plik nie zostanie znaleziony, wywoływany jest błąd oraz wyświetlany odpowiedni komunikat.
3. Po zczytaniu sekwencji program prosi użytkownika o podanie id/nazwy sekwencji za pomocą funkcji input. Po podaniu nazwy prosi o sekwencję w pętli while. Umieściłam tę pętlę po to, aby użytkownik po podaniu błędnej sekwencji (takiej, która po sprawdzeniu funkcją zwraca wartość False) miał możliwość jej poprawienia.
4. Gdy użytkownik poda prawidłową sekwencję, zostaje utworzony obiekt typu Bio.SeqRecord.SeqRecord.
5. Następnie dodaję go do wcześniej zczytanej listy sekwencji oraz zapisuję go do pliku (plik zostaje otworzony w trybie 'a', aby nie nadpisywać jego zawartości, a jedynie dodać nową sekwencję).
6. W pętli for dla każdej sekwencji liczę liczbę wystąpień nukleotydów A, C, T i G, a także częstotliwość wystąpień GC (za pomocą funkcji counter), jej długość (za pomocą funkcji len) oraz wynik funkcji sprawdz_sekwencje_dna. Następnie wyświetlam wszystkie informacje o sekwencji.
7. Tworzę słownik z listy sekwencji. Jako klucze słownika wykorzystuję id sekwencji, a jako wartości - same obiekty sekwencji. W tym kroku rozwiązuję problem duplikatów istniejących w pliku, ponieważ słowniki nie mogą zawierać dwóch takich samych kluczy.
8. Tworzę obiekt typu DataFrame na podstawie słownika, wykorzystując klucze oraz obiekty sekwencji. Dodaję również kolumny, które mnie interesują. Dla każdego obiektu wyciągam opis oraz sekwencję (którą zamieniam na obiekt typu string). Wyodrębniam także nazwę organizmu zawartą w opisie (tylko jeśli opis jest dostępny). Dodatkowo dodaję kolumnę z długością sekwencji.
9. Usuwam niepoprawne sekwencje za pomocą funkcji apply oraz wcześniej zdefiniowanej funkcji sprawdz_sekwencje_dna.
10. W tym kroku przechodzę do wizualizacji. Pierwsza wizualizacja przedstawia liczbę sekwencji przypadających na dany organizm. Aby nie umieszczać zbyt dużej liczby danych na wykresie, wybieram tylko pięć najczęściej występujących organizmów (za pomocą value_counts().head(5)). Na podstawie tego zbioru tworzę wykres przy użyciu biblioteki matplotlib, dobierając odpowiednie opisy osi oraz tytuł.
11. W drugiej wizualizacji przedstawiam ogólną częstotliwość występowania nukleotydów A, C, T i G we wszystkich sekwencjach. W tym celu łączę wszystkie sekwencje w jeden łańcuch znaków i wykorzystuję klasę Counter.
12. W trzeciej wizualizacji tworzę histogram przedstawiający rozkład długości sekwencji, korzystając z wcześniej dodanej kolumny z długościami.
13. W czwartej wizualizacji tworzę obiekt typu Series, który dla każdego organizmu oblicza średnią długość sekwencji przy użyciu funkcji groupby oraz mean. Następnie wybieram pięć organizmów (head(5)) o najwyższej średniej długości i tworzę dla nich wykres punktowy.